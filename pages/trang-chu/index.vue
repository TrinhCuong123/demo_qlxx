<template>
  <div class="grid grid-cols-3">
    <div class="col-span-2">
      <div class="grid grid-cols-3 justify-items-center gap-4 m-5">
        <div class="span-col-1 bg-white rounded-lg w-full">
          <div style="display: flex; align-items: center;" class="m-4 pl-3">
            <svg width="45" height="38" viewBox="0 0 45 38" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g opacity="0.3">
                <ellipse cx="20.9129" cy="16.2532" rx="16.087" ry="16.1027" fill="#9FA324" />
                <ellipse cx="2.41304" cy="2.56595" rx="2.41304" ry="2.4154" fill="#9FA324" />
              </g>
              <path
                d="M23.6904 24.2104C23.6904 25.9415 25.0176 27.337 26.6665 27.337H30.0314C31.4658 27.337 32.6321 26.1159 32.6321 24.613C32.6321 22.9759 31.9216 22.3989 30.8625 22.0231L25.46 20.1445C24.4009 19.7688 23.6904 19.1918 23.6904 17.5546C23.6904 16.0517 24.8567 14.8306 26.2912 14.8306H29.656C31.3049 14.8306 32.6321 16.2262 32.6321 17.9572"
                stroke="#9FA324" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M28.1521 13.0327V29.1354" stroke="#9FA324" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
              <path
                d="M28.1521 34.5029C35.556 34.5029 41.5579 28.4951 41.5579 21.084C41.5579 13.673 35.556 7.66513 28.1521 7.66513C20.7483 7.66513 14.7463 13.673 14.7463 21.084C14.7463 28.4951 20.7483 34.5029 28.1521 34.5029Z"
                stroke="#9FA324" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <div style="margin-left: 8px;" class="text-sm font-bold">Lợi nhuận</div>
          </div>
          <div class="span-col-1 flex justify-between px-3">
            <div class="m-4 items-center">
              <div class="font-bold text-xl">50.000.000 &#8363;</div>
              <div class=" text-sm">Thời điểm: Tháng 12</div>
            </div>
            <div class="items-center">
              <svg width="98" height="55" viewBox="0 0 98 55" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path opacity="0.9"
                  d="M0 15.2414C0 13.5846 1.34315 12.2414 3 12.2414H4.84914C5.65877 12.2414 6.43402 12.5687 6.99877 13.1488L7.62019 13.7872C8.79794 14.997 10.7417 14.997 11.9195 13.7872L12.5409 13.1488C13.1056 12.5687 13.8809 12.2414 14.6905 12.2414H16.6888C18.3457 12.2414 19.6888 13.5846 19.6888 15.2414V51.473C19.6888 53.1298 18.3457 54.473 16.6888 54.473H3C1.34315 54.473 0 53.1298 0 51.473V15.2414Z"
                  fill="#04091E" />
                <path opacity="0.9"
                  d="M77.6787 21.4784C77.6787 19.6938 79.1254 18.2471 80.91 18.2471H82.6787C83.4593 18.2471 84.2134 18.5296 84.8019 19.0425L85.4774 19.6312C86.6941 20.6918 88.5069 20.6918 89.7236 19.6312L90.3991 19.0425C90.9875 18.5296 91.7417 18.2471 92.5222 18.2471H94.4424C96.227 18.2471 97.6737 19.6938 97.6737 21.4784V51.4059C97.6737 53.1905 96.227 54.6372 94.4424 54.6372H80.91C79.1254 54.6372 77.6787 53.1905 77.6787 51.4059V21.4784Z"
                  fill="#04091E" />
                <path opacity="0.9"
                  d="M28.9198 29C27.1352 29 25.6885 30.4467 25.6885 32.2313V51C25.6885 52.6569 27.0316 54 28.6885 54H42.6835C44.3404 54 45.6835 52.6569 45.6835 51V32.2313C45.6835 30.4467 44.2368 29 42.4522 29H40.9171C39.9113 29 38.9629 29.4684 38.3514 30.267L38.1759 30.4962C36.8826 32.1855 34.3379 32.1855 33.0446 30.4962L32.8691 30.267C32.2576 29.4684 31.3092 29 30.3034 29H28.9198Z"
                  fill="#9FA324" />
                <path opacity="0.9"
                  d="M54.6836 0C53.0267 0 51.6836 1.34314 51.6836 3V51C51.6836 52.6569 53.0267 54 54.6836 54H68.6786C70.3355 54 71.6786 52.6569 71.6786 51V3C71.6786 1.34315 70.3355 0 68.6786 0H66.9773C65.944 0 64.9835 0.531746 64.4349 1.40741L64.1477 1.86588C62.9722 3.74243 60.2385 3.74243 59.063 1.86588L58.7758 1.40741C58.2273 0.531746 57.2667 0 56.2334 0H54.6836Z"
                  fill="#04091E" />
              </svg>
            </div>
          </div>
        </div>
        <div class="span-col-1 bg-white rounded-lg w-full">
          <div style="display: flex; align-items: center;" class="m-4 pl-3">
            <svg width="44" height="37" viewBox="0 0 44 37" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g opacity="0.3">
                <ellipse cx="20.9129" cy="16.2532" rx="16.087" ry="16.1027" fill="#9FA324" />
                <ellipse cx="2.41304" cy="2.56595" rx="2.41304" ry="2.4154" fill="#9FA324" />
              </g>
              <path
                d="M20.0001 10.3333H36.0001C38.9456 10.3333 41.3334 12.7212 41.3334 15.6667V22.3333C41.3334 25.2789 38.9456 27.6667 36.0001 27.6667H25.3334C22.3879 27.6667 20.0001 25.2789 20.0001 22.3333V10.3333ZM20.0001 10.3333C20.0001 8.86058 18.8062 7.66667 17.3334 7.66667H14.6667"
                stroke="#9FA324" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              <path
                d="M26.6667 32.3333C26.6667 33.4379 25.7713 34.3333 24.6667 34.3333C23.5622 34.3333 22.6667 33.4379 22.6667 32.3333C22.6667 31.2288 23.5622 30.3333 24.6667 30.3333C25.7713 30.3333 26.6667 31.2288 26.6667 32.3333Z"
                stroke="#9FA324" stroke-width="2" />
              <path
                d="M38.6667 32.3333C38.6667 33.4379 37.7713 34.3333 36.6667 34.3333C35.5622 34.3333 34.6667 33.4379 34.6667 32.3333C34.6667 31.2288 35.5622 30.3333 36.6667 30.3333C37.7713 30.3333 38.6667 31.2288 38.6667 32.3333Z"
                stroke="#9FA324" stroke-width="2" />
              <path d="M26.6667 21C29.8083 22.7871 31.5302 22.7684 34.6667 21" stroke="#9FA324" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <div style="margin-left: 8px;" class="text-sm font-bold">Chi phí hàng hóa</div>
          </div>
          <div class="flex justify-between px-3">
            <div class="m-4 items-center">
              <div class="font-bold text-xl">25.000.000 &#8363;</div>
              <div class=" text-sm">Thời điểm: Tháng 12</div>
            </div>
            <div class="items-center">
              <svg width="98" height="55" viewBox="0 0 98 55" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path opacity="0.9"
                  d="M0 15.2414C0 13.5846 1.34315 12.2414 3 12.2414H4.84914C5.65877 12.2414 6.43402 12.5687 6.99877 13.1488L7.62019 13.7872C8.79794 14.997 10.7417 14.997 11.9195 13.7872L12.5409 13.1488C13.1056 12.5687 13.8809 12.2414 14.6905 12.2414H16.6888C18.3457 12.2414 19.6888 13.5846 19.6888 15.2414V51.473C19.6888 53.1298 18.3457 54.473 16.6888 54.473H3C1.34315 54.473 0 53.1298 0 51.473V15.2414Z"
                  fill="#04091E" />
                <path opacity="0.9"
                  d="M77.6787 21.4784C77.6787 19.6938 79.1254 18.2471 80.91 18.2471H82.6787C83.4593 18.2471 84.2134 18.5296 84.8019 19.0425L85.4774 19.6312C86.6941 20.6918 88.5069 20.6918 89.7236 19.6312L90.3991 19.0425C90.9875 18.5296 91.7417 18.2471 92.5222 18.2471H94.4424C96.227 18.2471 97.6737 19.6938 97.6737 21.4784V51.4059C97.6737 53.1905 96.227 54.6372 94.4424 54.6372H80.91C79.1254 54.6372 77.6787 53.1905 77.6787 51.4059V21.4784Z"
                  fill="#04091E" />
                <path opacity="0.9"
                  d="M28.9198 29C27.1352 29 25.6885 30.4467 25.6885 32.2313V51C25.6885 52.6569 27.0316 54 28.6885 54H42.6835C44.3404 54 45.6835 52.6569 45.6835 51V32.2313C45.6835 30.4467 44.2368 29 42.4522 29H40.9171C39.9113 29 38.9629 29.4684 38.3514 30.267L38.1759 30.4962C36.8826 32.1855 34.3379 32.1855 33.0446 30.4962L32.8691 30.267C32.2576 29.4684 31.3092 29 30.3034 29H28.9198Z"
                  fill="#9FA324" />
                <path opacity="0.9"
                  d="M54.6836 0C53.0267 0 51.6836 1.34314 51.6836 3V51C51.6836 52.6569 53.0267 54 54.6836 54H68.6786C70.3355 54 71.6786 52.6569 71.6786 51V3C71.6786 1.34315 70.3355 0 68.6786 0H66.9773C65.944 0 64.9835 0.531746 64.4349 1.40741L64.1477 1.86588C62.9722 3.74243 60.2385 3.74243 59.063 1.86588L58.7758 1.40741C58.2273 0.531746 57.2667 0 56.2334 0H54.6836Z"
                  fill="#04091E" />
              </svg>
            </div>
          </div>
        </div>
        <div class="bg-white rounded-lg w-full">
          <div style="display: flex; align-items: center;" class="m-4 pl-3">
            <svg xmlns="http://www.w3.org/2000/svg" width="45" height="38" viewBox="0 0 64 64">
              <path fill="#9FA324"
                d="M61.9 44.8c-1.1-3.4-4.7-5.3-8.1-4.4l-12.1 2.9c-.3-2.9-2.6-5.3-5.8-5.8H23.1c-1-1.5-2.6-2.5-4.6-2.5H8c-3.4 0-6.3 2.8-6.3 6.3v12.4C1.7 57.1 4.5 60 8 60h10.5c1.5 0 3-.6 4-1.7c.2-.2.3-.4.5-.6c2.9 1.4 6 2.2 9.1 2.2c1.9 0 3.8-.3 5.6-.8L53 54.5l4.3-1.3c1.7-.5 3.2-1.6 4.1-3.2c.9-1.5 1.1-3.4.5-5.2M19.3 54.9c-.2.2-.5.3-.8.3H8c-1 0-1.8-.8-1.8-1.8V41.1c0-1 .8-1.8 1.8-1.8h10.7c.5 0 .9.4.9.9v14c0 .4-.2.6-.3.7m38.2-7c-.3.5-.7.9-1.3 1l-4.4 1.3l-15.2 4.3c-3.9 1.1-8 .7-11.6-1.1l-.9-.5v-11h11.5c1.1.2 1.8 1 1.8 1.9v.5l-3.4.8c-1.2.3-2 1.5-1.7 2.7s1.5 2 2.7 1.7l20-4.8c1.1-.3 2.3.3 2.7 1.4c.1.6.1 1.3-.2 1.8M47.3 21.5h5.1c1.5 0 2.8 1.3 2.8 2.8s-1.3 2.8-2.8 2.8h-7.7c-1.2 0-2.3 1-2.3 2.3s1 2.3 2.3 2.3h2.8v.3c0 1.2 1 2.3 2.3 2.3s2.3-1 2.3-2.3v-.3h.3c4 0 7.3-3.3 7.3-7.3s-3.3-7.3-7.3-7.3h-5.1c-1.5 0-2.8-1.3-2.8-2.8s1.3-2.8 2.8-2.8h7.6c1.2 0 2.3-1 2.3-2.3s-1-2.3-2.3-2.3h-2.8v-.4c0-1.2-1-2.3-2.3-2.3s-2.3 1-2.3 2.3v.3h-.3c-4 0-7.3 3.3-7.3 7.3c.1 4.1 3.4 7.4 7.4 7.4" />
            </svg>
            <div style="margin-left: 8px;" class="text-sm font-bold">Doanh thu sửa xe</div>
          </div>
          <div>
            <div class="flex justify-between px-3">
              <div class="m-4 items-center">
                <div class="font-bold text-xl">75.000.000 &#8363;</div>
                <div class=" text-sm">Thời điểm: Tháng 12</div>
              </div>
              <div class="items-center">
                <svg width="98" height="55" viewBox="0 0 98 55" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path opacity="0.9"
                    d="M0 15.2414C0 13.5846 1.34315 12.2414 3 12.2414H4.84914C5.65877 12.2414 6.43402 12.5687 6.99877 13.1488L7.62019 13.7872C8.79794 14.997 10.7417 14.997 11.9195 13.7872L12.5409 13.1488C13.1056 12.5687 13.8809 12.2414 14.6905 12.2414H16.6888C18.3457 12.2414 19.6888 13.5846 19.6888 15.2414V51.473C19.6888 53.1298 18.3457 54.473 16.6888 54.473H3C1.34315 54.473 0 53.1298 0 51.473V15.2414Z"
                    fill="#04091E" />
                  <path opacity="0.9"
                    d="M77.6787 21.4784C77.6787 19.6938 79.1254 18.2471 80.91 18.2471H82.6787C83.4593 18.2471 84.2134 18.5296 84.8019 19.0425L85.4774 19.6312C86.6941 20.6918 88.5069 20.6918 89.7236 19.6312L90.3991 19.0425C90.9875 18.5296 91.7417 18.2471 92.5222 18.2471H94.4424C96.227 18.2471 97.6737 19.6938 97.6737 21.4784V51.4059C97.6737 53.1905 96.227 54.6372 94.4424 54.6372H80.91C79.1254 54.6372 77.6787 53.1905 77.6787 51.4059V21.4784Z"
                    fill="#04091E" />
                  <path opacity="0.9"
                    d="M28.9198 29C27.1352 29 25.6885 30.4467 25.6885 32.2313V51C25.6885 52.6569 27.0316 54 28.6885 54H42.6835C44.3404 54 45.6835 52.6569 45.6835 51V32.2313C45.6835 30.4467 44.2368 29 42.4522 29H40.9171C39.9113 29 38.9629 29.4684 38.3514 30.267L38.1759 30.4962C36.8826 32.1855 34.3379 32.1855 33.0446 30.4962L32.8691 30.267C32.2576 29.4684 31.3092 29 30.3034 29H28.9198Z"
                    fill="#9FA324" />
                  <path opacity="0.9"
                    d="M54.6836 0C53.0267 0 51.6836 1.34314 51.6836 3V51C51.6836 52.6569 53.0267 54 54.6836 54H68.6786C70.3355 54 71.6786 52.6569 71.6786 51V3C71.6786 1.34315 70.3355 0 68.6786 0H66.9773C65.944 0 64.9835 0.531746 64.4349 1.40741L64.1477 1.86588C62.9722 3.74243 60.2385 3.74243 59.063 1.86588L58.7758 1.40741C58.2273 0.531746 57.2667 0 56.2334 0H54.6836Z"
                    fill="#04091E" />
                </svg>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="flex justify-items-center gap-4 m-5 ">
        <div class=" bg-white rounded-lg w-full">
          <div style=" align-items: center;" class="m-4 pl-3">
            <div>
              <div class="text-sm opacity-80">Doanh thu của năm</div>
              <div class="text-xl font-bold">500.000.000 &#8363;</div>
            </div>
            <div class="card w-full">
              <Chart type="bar" :data="chartData" :options="chartOptions" class="h-[20rem]" />
            </div>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-2 justify-items-center gap-4 m-5">
        <div class="col-span-1 bg-white rounded-lg w-full">
          <div style=" align-items: center;" class="m-4 pl-3">
            <div>
              <div class="text-sm opacity-80">Doanh thu tháng 12</div>
              <div class="text-xl font-bold">50.000.000 &#8363;</div>
            </div>
            <div class="card flex justify-center">
              <Chart type="pie" :data="chartDataPie" :options="chartOptionPie" class="w-full md:w-[20rem]" />
            </div>
          </div>
        </div>
        <div class="col-span-1 bg-white rounded-lg w-full">
          <div style=" align-items: center;" class="m-4 pl-3">
            <div>
              <div class="text-sm opacity-80">Doanh thu tháng 12</div>
              <div class="text-xl font-bold">50.000.000 &#8363;</div>
            </div>
            <div class="card flex justify-center">
              <Chart type="pie" :data="chartDataPie" :options="chartOptionPie" class="w-full md:w-[20rem]" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="bg-white col-span-1 rounded-xl mt-5 mb-5 mr-5">
      <div class="m-3">
        <div class="flex items-center m-2">
          <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="45" height="38" viewBox="0 0 24 24" fill="none">
              <path fill="#9FA324" d="M1 11v10h5v-6h4v6h5V11L8 6z" />
              <path fill="#9FA324" d="M10 3v1.97l7 5V11h2v2h-2v2h2v2h-2v4h6V3zm9 6h-2V7h2z" />
            </svg>
          </div>
          <div class="font-bold text-xl ml-3">
            Địa chỉ khách hàng
          </div>
        </div>

        <div class="w-100 h-screen">
          <ClientOnly>
            <LMap ref="map" :options="{ attributionControl: false }" :zoom="5" :center="[17.175763, 106.699218]"
              :use-global-leaflet="false">
              <!-- <LTileLayer url="https://tiles.gisgo.vn/base/{z}/{x}/{y}.png" layer-type="base" name="OpenStreetMap" /> -->

              <LMap ref="map" :options="{ attributionControl: false }" :zoom="5" :center="[17.175763, 106.699218]"
                :use-global-leaflet="false">
                <!-- Lớp bản đồ 1: Google Satellite -->
                <LTileLayer url="https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}" attribution="&copy; Google Maps"
                  layer-type="base" name="Bản đồ Vệ tinh Google" />

                <!-- Lớp bản đồ 2: Google Terrain -->
                <LTileLayer url="https://mt1.google.com/vt/lyrs=p&x={x}&y={y}&z={z}" attribution="&copy; Google Maps"
                  layer-type="base" name="Bản đồ Địa hình Google" />

                <!-- Lớp bản đồ 3: OpenTopoMap -->
                <LTileLayer url="https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png"
                  attribution="Map data: &copy; <a href=&quot;https://www.opentopomap.org/&quot;>OpenTopoMap</a>"
                  layer-type="base" name="Bản đồ Địa hình Mở" />

                <!-- <LTileLayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
                  attribution="&amp;copy; <a href=&quot;https://www.openstreetmap.org/&quot;>OpenStreetMap</a> contributors"
                  layer-type="base" name="Bản đồ Đường phố Mở" /> -->
                <!-- Lớp điều khiển Layers Control -->
                <LControlLayers position="topright" />
              </LMap>
            </LMap>
          </ClientOnly>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { setTitleHeader } from '~/composables/globalTitleHeader';
import { ref, onMounted } from "vue";

setTitleHeader("");

onMounted(() => {
  chartData.value = setChartData();
  chartOptions.value = setChartOptions();
  chartDataPie.value = setChartDataPie();
  chartOptionPie.value = setChartOptionPies();
});

const chartData = ref();
const chartOptions = ref();

const setChartData = () => {
  const documentStyle = getComputedStyle(document.documentElement);

  return {
    labels: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12'],
    datasets: [
      {
        type: 'bar',
        label: 'Chi phí háng hóa',
        backgroundColor: documentStyle.getPropertyValue('--p-gray-500'),
        data: [50, 25, 12, 48, 90, 76, 42, 30, 52, 45, 60]
      },
      {
        type: 'bar',
        label: 'Doanh thu sửa xe',
        backgroundColor: documentStyle.getPropertyValue('--p-cyan-500'),
        data: [21, 84, 24, 75, 37, 65, 34, 53, 63, 76, 64]
      },
      {
        type: 'bar',
        label: 'Lợi nhuận',
        backgroundColor: documentStyle.getPropertyValue('--p-orange-500'),
        data: [41, 52, 24, 74, 23, 21, 32, 56, 86, 92, 63]
      }
    ]
  };
};
const setChartOptions = () => {
  const documentStyle = getComputedStyle(document.documentElement);
  const textColor = documentStyle.getPropertyValue('--p-text-color');
  const textColorSecondary = documentStyle.getPropertyValue('--p-text-muted-color');
  const surfaceBorder = documentStyle.getPropertyValue('--p-content-border-color');

  return {
    maintainAspectRatio: false,
    aspectRatio: 0.8,
    plugins: {
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      legend: {
        labels: {
          color: textColor
        }
      }
    },
    scales: {
      x: {
        stacked: true,
        ticks: {
          color: textColorSecondary
        },
        grid: {
          color: surfaceBorder
        }
      },
      y: {
        stacked: true,
        ticks: {
          color: textColorSecondary
        },
        grid: {
          color: surfaceBorder
        }
      }
    }
  };
}


const chartDataPie = ref();
const chartOptionPie = ref();

const setChartDataPie = () => {
  const documentStyle = getComputedStyle(document.body);

  return {
    labels: ['Chi phí háng hóa', 'Doanh thu sửa xe', 'Lợi nhuận'],
    datasets: [
      {
        data: [540, 325, 702],
        backgroundColor: [documentStyle.getPropertyValue('--p-gray-500'), documentStyle.getPropertyValue('--p-cyan-500'), documentStyle.getPropertyValue('--p-orange-500')],
        hoverBackgroundColor: [documentStyle.getPropertyValue('--p-gray-500'), documentStyle.getPropertyValue('--p-cyan-500'), documentStyle.getPropertyValue('--p-orange-500')]
      }
    ]
  };
};

const setChartOptionPies = () => {
  const documentStyle = getComputedStyle(document.documentElement);
  const textColor = documentStyle.getPropertyValue('--p-text-color');

  return {
    plugins: {
      legend: {
        labels: {
          usePointStyle: true,
          color: textColor
        }
      }
    }
  };
};
</script>

<style></style>